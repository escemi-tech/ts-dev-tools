name: Shared - Continuous Integration for common tasks

on:
  workflow_call:
    outputs:
      build-artifact-id:
        description: "The ID of the build artifact"
        value: ${{ jobs.continuous-integration.outputs.build-artifact-id }}

permissions: {}

jobs:
  continuous-integration:
    uses: hoverkraft-tech/ci-github-nodejs/.github/workflows/continuous-integration.yml@ce2467e5d41ff0abe85094dcc39c98288448065a # 0.20.4
    permissions:
      contents: read
      id-token: write
      packages: read
      pull-requests: write
      security-events: write
    with:
      build: '{"artifact":"packages/*/dist"}'
      test: |
        {"coverage": "codecov"}
